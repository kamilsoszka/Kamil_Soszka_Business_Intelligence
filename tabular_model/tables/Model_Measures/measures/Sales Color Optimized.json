{
  "name": "Sales Color Optimized",
  "expression": [
    "",
    "/*",
    "    Business Goal: This measure returns a color code (hex) based on the Year-over-Year (YoY)",
    "    change in Sales. It is designed for conditional formatting in reports to visually",
    "    indicate performance trends - green for sales growth, red for sales decline,",
    "    and gray for no change. The measure returns a text value suitable for font color,",
    "    background color, or icon conditional formatting in various visualizations.",
    "",
    "    Function Explanation:",
    "    VAR: Used to declare variables that store intermediate calculation results.",
    "    This improves performance and code readability by calculating values once.",
    "*/",
    "VAR Current_Sales = ",
    "    /*",
    "        IFERROR: Evaluates the [Sales] measure and returns it if no error occurs.",
    "        If an error is encountered, it returns BLANK() instead.",
    "        This ensures the measure handles calculation errors gracefully without breaking",
    "        and maintains data cleanliness.",
    "    */",
    "    IFERROR( [Sales], BLANK() )",
    "",
    "VAR Previous_Year_Sales =",
    "    /*",
    "        CALCULATE: Modifies the filter context for the [Sales] measure evaluation.",
    "        SAMEPERIODLASTYEAR: A time intelligence function that takes a date column",
    "        and returns a set of dates from the previous year corresponding to the current",
    "        date context. For example, if viewing March 2024, it returns dates for March 2023.",
    "        This enables accurate year-over-year comparisons for sales performance.",
    "    */",
    "    CALCULATE (",
    "        IFERROR( [Sales], BLANK() ),",
    "        SAMEPERIODLASTYEAR ( 'Dates Optimized'[Date] )",
    "    )",
    "",
    "// Calculates the absolute Year-over-Year Change: Current Period - Previous Year",
    "VAR YoY_Change_Absolute = ",
    "    /*",
    "        COALESCE: Returns the first expression that does not evaluate to BLANK.",
    "        Here, it replaces BLANK values with 0 to ensure correct arithmetic operations",
    "        in the subtraction. This prevents calculation errors when either current or",
    "        previous year sales data is missing.",
    "    */",
    "    COALESCE( Current_Sales, 0 ) - COALESCE( Previous_Year_Sales, 0 )",
    "",
    "RETURN",
    "    /*",
    "        SWITCH: Evaluates multiple conditions and returns one of several result expressions.",
    "        TRUE(): Used as the first argument to enable conditional logic based on the value",
    "        of YoY_Change_Absolute. This structure checks each condition in sequence.",
    "    */",
    "    SWITCH (",
    "        TRUE(),",
    "        // Condition 1: Sales increased (Green) - Favorable performance",
    "        YoY_Change_Absolute > 0, \"#00A650\", ",
    "        // Condition 2: Sales decreased (Red) - Unfavorable performance",
    "        YoY_Change_Absolute < 0, \"#E60000\", ",
    "        // Condition 3: No change, zero, or BLANK (Gray) - Neutral performance",
    "        \"#7F8C8D\" ",
    "    )"
  ],
  "displayFolder": "sales",
  "lineageTag": "7c1ca75b-cee2-43a4-9df4-dfc86600b45c"
}